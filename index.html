import React, { useState, useEffect } from 'react';
import { Calendar, Clock, Heart, Palette, TrendingUp, CheckCircle, Circle, Plus, X, Edit2, Save, BarChart3, Target, FileText, Briefcase } from 'lucide-react';

const WellnessScheduleApp = () => {
  const [currentView, setCurrentView] = useState('daily');
  const [selectedDate, setSelectedDate] = useState(new Date());
  const [tasks, setTasks] = useState({});
  const [habits, setHabits] = useState({});
  const [weeklyGoals, setWeeklyGoals] = useState([]);
  const [contentPlans, setContentPlans] = useState([]);
  const [clientProjects, setClientProjects] = useState([]);
  const [isEditing, setIsEditing] = useState(false);
  const [newTask, setNewTask] = useState({ text: '', time: '', category: 'wellness', period: 'morning' });
  const [showAddTask, setShowAddTask] = useState(false);
  const [showAddGoal, setShowAddGoal] = useState(false);
  const [showAddContent, setShowAddContent] = useState(false);
  const [showAddProject, setShowAddProject] = useState(false);
  const [newGoal, setNewGoal] = useState('');
  const [newContent, setNewContent] = useState({ platform: 'Instagram', topic: '', scheduledDate: '' });
  const [newProject, setNewProject] = useState({ client: '', type: '', deadline: '', status: 'inquiry' });

  // Load data from storage
  useEffect(() => {
    const loadData = async () => {
      try {
        const tasksData = await window.storage.get('schedule-tasks');
        const habitsData = await window.storage.get('schedule-habits');
        const goalsData = await window.storage.get('schedule-goals');
        const contentData = await window.storage.get('schedule-content');
        const projectsData = await window.storage.get('schedule-projects');
        
        if (tasksData) setTasks(JSON.parse(tasksData.value));
        if (habitsData) setHabits(JSON.parse(habitsData.value));
        if (goalsData) setWeeklyGoals(JSON.parse(goalsData.value));
        if (contentData) setContentPlans(JSON.parse(contentData.value));
        if (projectsData) setClientProjects(JSON.parse(projectsData.value));
      } catch (error) {
        // Initialize with sample data if storage is empty
        initializeSampleData();
      }
    };
    loadData();
  }, []);

  const initializeSampleData = () => {
    const today = new Date().toDateString();
    
    // Create sample tasks for today and next few days
    const todayTasks = {
      morning: [
        { id: Date.now(), text: 'Morning skincare routine', completed: false, time: '7:00 AM', category: 'wellness' },
        { id: Date.now() + 1, text: 'Breakfast & journal', completed: false, time: '7:30 AM', category: 'wellness' }
      ],
      midday: [
        { id: Date.now() + 2, text: 'SolidCore class or gym workout', completed: false, time: '9:00 AM', category: 'fitness' },
        { id: Date.now() + 3, text: 'Social media content creation', completed: false, time: '11:00 AM', category: 'social' },
        { id: Date.now() + 4, text: 'Client design work - 2 hours', completed: false, time: '1:00 PM', category: 'design' }
      ],
      afternoon: [
        { id: Date.now() + 5, text: 'Outdoor walk or movement', completed: false, time: '3:00 PM', category: 'wellness' },
        { id: Date.now() + 6, text: 'Content planning & scheduling', completed: false, time: '4:00 PM', category: 'social' }
      ],
      evening: [
        { id: Date.now() + 7, text: 'Design portfolio updates', completed: false, time: '6:00 PM', category: 'design' },
        { id: Date.now() + 8, text: 'Evening skincare & wind down', completed: false, time: '8:00 PM', category: 'wellness' }
      ]
    };
    
    const sampleTasks = {
      [today]: todayTasks
    };
    
    // Add tasks for tomorrow
    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 1);
    const tomorrowKey = tomorrow.toDateString();
    sampleTasks[tomorrowKey] = {
      morning: [
        { id: Date.now() + 100, text: 'Morning skincare routine', completed: false, time: '7:00 AM', category: 'wellness' },
        { id: Date.now() + 101, text: 'Meditation & journaling', completed: false, time: '7:30 AM', category: 'wellness' }
      ],
      midday: [
        { id: Date.now() + 102, text: 'Gym workout', completed: false, time: '9:30 AM', category: 'fitness' },
        { id: Date.now() + 103, text: 'Work on client watercolor project', completed: false, time: '11:00 AM', category: 'design' }
      ],
      afternoon: [
        { id: Date.now() + 104, text: 'Film content for Instagram', completed: false, time: '2:00 PM', category: 'social' },
        { id: Date.now() + 105, text: 'Outdoor walk', completed: false, time: '4:00 PM', category: 'wellness' }
      ],
      evening: [
        { id: Date.now() + 106, text: 'Edit and schedule posts', completed: false, time: '6:00 PM', category: 'social' },
        { id: Date.now() + 107, text: 'Evening skincare', completed: false, time: '8:30 PM', category: 'wellness' }
      ]
    };
    
    // Add tasks for day after tomorrow
    const dayAfter = new Date();
    dayAfter.setDate(dayAfter.getDate() + 2);
    const dayAfterKey = dayAfter.toDateString();
    sampleTasks[dayAfterKey] = {
      morning: [
        { id: Date.now() + 200, text: 'Morning skincare routine', completed: false, time: '7:00 AM', category: 'wellness' },
        { id: Date.now() + 201, text: 'Healthy breakfast prep', completed: false, time: '7:45 AM', category: 'wellness' }
      ],
      midday: [
        { id: Date.now() + 202, text: 'SolidCore class', completed: false, time: '10:00 AM', category: 'fitness' },
        { id: Date.now() + 203, text: 'Client consultation call', completed: false, time: '12:00 PM', category: 'design' }
      ],
      afternoon: [
        { id: Date.now() + 204, text: 'Work on digital design project', completed: false, time: '2:00 PM', category: 'design' },
        { id: Date.now() + 205, text: 'Content brainstorming session', completed: false, time: '4:00 PM', category: 'social' }
      ],
      evening: [
        { id: Date.now() + 206, text: 'Review weekly goals', completed: false, time: '6:00 PM', category: 'wellness' },
        { id: Date.now() + 207, text: 'Evening routine & skincare', completed: false, time: '8:00 PM', category: 'wellness' }
      ]
    };

    const sampleHabits = {
      [today]: [
        { id: 1, name: 'Morning skincare', completed: false },
        { id: 2, name: 'Workout/movement', completed: false },
        { id: 3, name: 'Posted content', completed: false },
        { id: 4, name: 'Design work', completed: false },
        { id: 5, name: 'Evening skincare', completed: false }
      ]
    };

    const sampleGoals = [
      { id: 1, text: 'Post 5 pieces of content this week', completed: false },
      { id: 2, text: 'Complete 2 client projects', completed: false },
      { id: 3, text: 'Workout 4 times', completed: false },
      { id: 4, text: 'Update portfolio with new designs', completed: false }
    ];

    const sampleContent = [
      { id: 1, platform: 'Instagram', topic: 'Morning wellness routine', scheduledDate: today, status: 'scheduled' },
      { id: 2, platform: 'TikTok', topic: 'Design process timelapse', scheduledDate: today, status: 'draft' },
      { id: 3, platform: 'Instagram', topic: 'Healthy meal prep ideas', scheduledDate: tomorrowKey, status: 'draft' },
      { id: 4, platform: 'YouTube', topic: 'Watercolor tutorial', scheduledDate: dayAfterKey, status: 'draft' }
    ];

    const sampleProjects = [
      { id: 1, client: 'Wellness Brand Co', type: 'Digital branding', deadline: today, status: 'in-progress' },
      { id: 2, client: 'Local Boutique', type: 'Watercolor illustrations', deadline: tomorrowKey, status: 'inquiry' },
      { id: 3, client: 'Lifestyle Blog', type: 'Social media graphics', deadline: dayAfterKey, status: 'in-progress' }
    ];

    setTasks(sampleTasks);
    setHabits(sampleHabits);
    setWeeklyGoals(sampleGoals);
    setContentPlans(sampleContent);
    setClientProjects(sampleProjects);
  };

  // Save data to storage
  const saveData = async () => {
    try {
      await window.storage.set('schedule-tasks', JSON.stringify(tasks));
      await window.storage.set('schedule-habits', JSON.stringify(habits));
      await window.storage.set('schedule-goals', JSON.stringify(weeklyGoals));
      await window.storage.set('schedule-content', JSON.stringify(contentPlans));
      await window.storage.set('schedule-projects', JSON.stringify(clientProjects));
    } catch (error) {
      console.error('Error saving data:', error);
    }
  };

  useEffect(() => {
    saveData();
  }, [tasks, habits, weeklyGoals, contentPlans, clientProjects]);

  // Initialize day if it doesn't exist
  useEffect(() => {
    const dateKey = selectedDate.toDateString();
    setTasks(prev => {
      if (!prev[dateKey]) {
        return {
          ...prev,
          [dateKey]: { morning: [], midday: [], afternoon: [], evening: [] }
        };
      }
      return prev;
    });
    setHabits(prev => {
      if (!prev[dateKey]) {
        return {
          ...prev,
          [dateKey]: [
            { id: Date.now(), name: 'Morning skincare', completed: false },
            { id: Date.now() + 1, name: 'Workout/movement', completed: false },
            { id: Date.now() + 2, name: 'Posted content', completed: false },
            { id: Date.now() + 3, name: 'Design work', completed: false },
            { id: Date.now() + 4, name: 'Evening skincare', completed: false }
          ]
        };
      }
      return prev;
    });
  }, [selectedDate]);

  const toggleTask = (period, taskId) => {
    const dateKey = selectedDate.toDateString();
    setTasks(prev => ({
      ...prev,
      [dateKey]: {
        ...prev[dateKey],
        [period]: prev[dateKey][period].map(task =>
          task.id === taskId ? { ...task, completed: !task.completed } : task
        )
      }
    }));
  };

  const addTask = () => {
    const dateKey = selectedDate.toDateString();
    const task = {
      id: Date.now(),
      text: newTask.text,
      time: newTask.time,
      category: newTask.category,
      completed: false
    };
    
    setTasks(prev => ({
      ...prev,
      [dateKey]: {
        ...prev[dateKey],
        [newTask.period]: [...(prev[dateKey]?.[newTask.period] || []), task]
      }
    }));
    
    setNewTask({ text: '', time: '', category: 'wellness', period: 'morning' });
    setShowAddTask(false);
  };

  const deleteTask = (period, taskId) => {
    const dateKey = selectedDate.toDateString();
    setTasks(prev => ({
      ...prev,
      [dateKey]: {
        ...prev[dateKey],
        [period]: prev[dateKey][period].filter(task => task.id !== taskId)
      }
    }));
  };

  const toggleHabit = (habitId) => {
    const dateKey = selectedDate.toDateString();
    setHabits(prev => ({
      ...prev,
      [dateKey]: prev[dateKey].map(habit =>
        habit.id === habitId ? { ...habit, completed: !habit.completed } : habit
      )
    }));
  };

  const addWeeklyGoal = () => {
    if (newGoal.trim()) {
      setWeeklyGoals(prev => [...prev, { id: Date.now(), text: newGoal, completed: false }]);
      setNewGoal('');
      setShowAddGoal(false);
    }
  };

  const toggleGoal = (goalId) => {
    setWeeklyGoals(prev => prev.map(goal =>
      goal.id === goalId ? { ...goal, completed: !goal.completed } : goal
    ));
  };

  const deleteGoal = (goalId) => {
    setWeeklyGoals(prev => prev.filter(goal => goal.id !== goalId));
  };

  const addContentPlan = () => {
    if (newContent.topic.trim()) {
      setContentPlans(prev => [...prev, {
        id: Date.now(),
        platform: newContent.platform,
        topic: newContent.topic,
        scheduledDate: newContent.scheduledDate,
        status: 'draft'
      }]);
      setNewContent({ platform: 'Instagram', topic: '', scheduledDate: '' });
      setShowAddContent(false);
    }
  };

  const updateContentStatus = (contentId, status) => {
    setContentPlans(prev => prev.map(content =>
      content.id === contentId ? { ...content, status } : content
    ));
  };

  const deleteContent = (contentId) => {
    setContentPlans(prev => prev.filter(content => content.id !== contentId));
  };

  const addClientProject = () => {
    if (newProject.client.trim()) {
      setClientProjects(prev => [...prev, {
        id: Date.now(),
        client: newProject.client,
        type: newProject.type,
        deadline: newProject.deadline,
        status: newProject.status
      }]);
      setNewProject({ client: '', type: '', deadline: '', status: 'inquiry' });
      setShowAddProject(false);
    }
  };

  const updateProjectStatus = (projectId, status) => {
    setClientProjects(prev => prev.map(project =>
      project.id === projectId ? { ...project, status } : project
    ));
  };

  const deleteProject = (projectId) => {
    setClientProjects(prev => prev.filter(project => project.id !== projectId));
  };

  const getCompletionStats = () => {
    const dateKey = selectedDate.toDateString();
    const dailyTasks = tasks[dateKey] || { morning: [], midday: [], afternoon: [], evening: [] };
    const allTasks = [...dailyTasks.morning, ...dailyTasks.midday, ...dailyTasks.afternoon, ...dailyTasks.evening];
    const completed = allTasks.filter(t => t.completed).length;
    const total = allTasks.length;
    
    const dailyHabits = habits[dateKey] || [];
    const habitsCompleted = dailyHabits.filter(h => h.completed).length;
    const habitsTotal = dailyHabits.length;
    
    const goalsCompleted = weeklyGoals.filter(g => g.completed).length;
    const goalsTotal = weeklyGoals.length;
    
    return {
      tasks: { completed, total, percentage: total > 0 ? Math.round((completed / total) * 100) : 0 },
      habits: { completed: habitsCompleted, total: habitsTotal, percentage: habitsTotal > 0 ? Math.round((habitsCompleted / habitsTotal) * 100) : 0 },
      goals: { completed: goalsCompleted, total: goalsTotal, percentage: goalsTotal > 0 ? Math.round((goalsCompleted / goalsTotal) * 100) : 0 }
    };
  };

  const getCategoryColor = (category) => {
    const colors = {
      wellness: 'bg-pink-100 text-pink-700',
      fitness: 'bg-purple-100 text-purple-700',
      social: 'bg-blue-100 text-blue-700',
      design: 'bg-amber-100 text-amber-700'
    };
    return colors[category] || 'bg-gray-100 text-gray-700';
  };

  const getCategoryIcon = (category) => {
    const icons = {
      wellness: <Heart className="w-4 h-4" />,
      fitness: <TrendingUp className="w-4 h-4" />,
      social: <Calendar className="w-4 h-4" />,
      design: <Palette className="w-4 h-4" />
    };
    return icons[category] || <Circle className="w-4 h-4" />;
  };

  const formatDate = (date) => {
    return date.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
  };

  const changeDate = (days) => {
    const newDate = new Date(selectedDate);
    newDate.setDate(newDate.getDate() + days);
    setSelectedDate(newDate);
  };

  const getDaysInMonth = (date) => {
    const year = date.getFullYear();
    const month = date.getMonth();
    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    const daysInMonth = lastDay.getDate();
    const startingDayOfWeek = firstDay.getDay();
    
    return { daysInMonth, startingDayOfWeek, month, year };
  };

  const renderAnalytics = () => {
    const stats = getCompletionStats();
    
    return (
      <div className="bg-white rounded-lg shadow-lg p-6">
        <h2 className="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
          <BarChart3 className="w-6 h-6" />
          Progress Analytics
        </h2>
        
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
          <div className="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-6">
            <h3 className="text-sm font-semibold text-blue-700 mb-2">Daily Tasks</h3>
            <div className="text-4xl font-bold text-blue-600 mb-2">{stats.tasks.percentage}%</div>
            <div className="text-sm text-gray-600">{stats.tasks.completed} of {stats.tasks.total} completed</div>
            <div className="w-full bg-blue-200 rounded-full h-2 mt-3">
              <div className="bg-blue-600 h-2 rounded-full" style={{ width: `${stats.tasks.percentage}%` }}></div>
            </div>
          </div>
          
          <div className="bg-gradient-to-br from-pink-50 to-pink-100 rounded-lg p-6">
            <h3 className="text-sm font-semibold text-pink-700 mb-2">Daily Habits</h3>
            <div className="text-4xl font-bold text-pink-600 mb-2">{stats.habits.percentage}%</div>
            <div className="text-sm text-gray-600">{stats.habits.completed} of {stats.habits.total} completed</div>
            <div className="w-full bg-pink-200 rounded-full h-2 mt-3">
              <div className="bg-pink-600 h-2 rounded-full" style={{ width: `${stats.habits.percentage}%` }}></div>
            </div>
          </div>
          
          <div className="bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-6">
            <h3 className="text-sm font-semibold text-purple-700 mb-2">Weekly Goals</h3>
            <div className="text-4xl font-bold text-purple-600 mb-2">{stats.goals.percentage}%</div>
            <div className="text-sm text-gray-600">{stats.goals.completed} of {stats.goals.total} completed</div>
            <div className="w-full bg-purple-200 rounded-full h-2 mt-3">
              <div className="bg-purple-600 h-2 rounded-full" style={{ width: `${stats.goals.percentage}%` }}></div>
            </div>
          </div>
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <h3 className="text-lg font-semibold text-gray-800 mb-4">Content Pipeline</h3>
            <div className="space-y-2">
              <div className="flex justify-between text-sm">
                <span className="text-gray-600">Draft</span>
                <span className="font-semibold">{contentPlans.filter(c => c.status === 'draft').length}</span>
              </div>
              <div className="flex justify-between text-sm">
                <span className="text-gray-600">Scheduled</span>
                <span className="font-semibold">{contentPlans.filter(c => c.status === 'scheduled').length}</span>
              </div>
              <div className="flex justify-between text-sm">
                <span className="text-gray-600">Published</span>
                <span className="font-semibold">{contentPlans.filter(c => c.status === 'published').length}</span>
              </div>
            </div>
          </div>
          
          <div>
            <h3 className="text-lg font-semibold text-gray-800 mb-4">Client Projects</h3>
            <div className="space-y-2">
              <div className="flex justify-between text-sm">
                <span className="text-gray-600">Inquiries</span>
                <span className="font-semibold">{clientProjects.filter(p => p.status === 'inquiry').length}</span>
              </div>
              <div className="flex justify-between text-sm">
                <span className="text-gray-600">In Progress</span>
                <span className="font-semibold">{clientProjects.filter(p => p.status === 'in-progress').length}</span>
              </div>
              <div className="flex justify-between text-sm">
                <span className="text-gray-600">Completed</span>
                <span className="font-semibold">{clientProjects.filter(p => p.status === 'completed').length}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    );
  };

  const renderWeeklyGoals = () => {
    return (
      <div className="bg-white rounded-lg shadow-lg p-6">
        <div className="flex items-center justify-between mb-4">
          <h2 className="text-2xl font-bold text-gray-800 flex items-center gap-2">
            <Target className="w-6 h-6" />
            Weekly Goals
          </h2>
          <button
            onClick={() => setShowAddGoal(true)}
            className="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 flex items-center gap-2"
          >
            <Plus className="w-4 h-4" />
            Add Goal
          </button>
        </div>
        
        {showAddGoal && (
          <div className="mb-4 p-4 bg-purple-50 rounded-lg">
            <input
              type="text"
              value={newGoal}
              onChange={(e) => setNewGoal(e.target.value)}
              placeholder="Enter your weekly goal..."
              className="w-full p-2 border rounded-lg mb-2"
            />
            <div className="flex gap-2">
              <button onClick={addWeeklyGoal} className="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600">
                Save
              </button>
              <button onClick={() => setShowAddGoal(false)} className="px-4 py-2 bg-gray-300 rounded-lg hover:bg-gray-400">
                Cancel
              </button>
            </div>
          </div>
        )}
        
        <div className="space-y-2">
          {weeklyGoals.map(goal => (
            <div key={goal.id} className="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
              <div onClick={() => toggleGoal(goal.id)} className="cursor-pointer">
                {goal.completed ? (
                  <CheckCircle className="w-6 h-6 text-green-500" />
                ) : (
                  <Circle className="w-6 h-6 text-gray-300" />
                )}
              </div>
              <span className={`flex-1 ${goal.completed ? 'line-through text-gray-500' : 'text-gray-800'}`}>
                {goal.text}
              </span>
              <button onClick={() => deleteGoal(goal.id)} className="text-red-500 hover:text-red-700">
                <X className="w-5 h-5" />
              </button>
            </div>
          ))}
        </div>
      </div>
    );
  };

  const renderContentPlanning = () => {
    return (
      <div className="bg-white rounded-lg shadow-lg p-6">
        <div className="flex items-center justify-between mb-4">
          <h2 className="text-2xl font-bold text-gray-800 flex items-center gap-2">
            <FileText className="w-6 h-6" />
            Content Calendar
          </h2>
          <button
            onClick={() => setShowAddContent(true)}
            className="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 flex items-center gap-2"
          >
            <Plus className="w-4 h-4" />
            Add Content
          </button>
        </div>
        
        {showAddContent && (
          <div className="mb-4 p-4 bg-blue-50 rounded-lg">
            <select
              value={newContent.platform}
              onChange={(e) => setNewContent({...newContent, platform: e.target.value})}
              className="w-full p-2 border rounded-lg mb-2"
            >
              <option>Instagram</option>
              <option>TikTok</option>
              <option>YouTube</option>
              <option>Blog</option>
            </select>
            <input
              type="text"
              value={newContent.topic}
              onChange={(e) => setNewContent({...newContent, topic: e.target.value})}
              placeholder="Content topic or idea..."
              className="w-full p-2 border rounded-lg mb-2"
            />
            <input
              type="date"
              value={newContent.scheduledDate}
              onChange={(e) => setNewContent({...newContent, scheduledDate: e.target.value})}
              className="w-full p-2 border rounded-lg mb-2"
            />
            <div className="flex gap-2">
              <button onClick={addContentPlan} className="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                Save
              </button>
              <button onClick={() => setShowAddContent(false)} className="px-4 py-2 bg-gray-300 rounded-lg hover:bg-gray-400">
                Cancel
              </button>
            </div>
          </div>
        )}
        
        <div className="space-y-3">
          {contentPlans.map(content => (
            <div key={content.id} className="p-4 bg-gray-50 rounded-lg">
              <div className="flex items-center justify-between mb-2">
                <div className="flex items-center gap-2">
                  <span className="font-semibold text-gray-800">{content.platform}</span>
                  <span className="text-sm text-gray-600">• {content.scheduledDate}</span>
                </div>
                <button onClick={() => deleteContent(content.id)} className="text-red-500 hover:text-red-700">
                  <X className="w-5 h-5" />
                </button>
              </div>
              <p className="text-gray-700 mb-2">{content.topic}</p>
              <select
                value={content.status}
                onChange={(e) => updateContentStatus(content.id, e.target.value)}
                className="text-sm p-1 border rounded"
              >
                <option value="draft">Draft</option>
                <option value="scheduled">Scheduled</option>
                <option value="published">Published</option>
              </select>
            </div>
          ))}
        </div>
      </div>
    );
  };

  const renderClientProjects = () => {
    return (
      <div className="bg-white rounded-lg shadow-lg p-6">
        <div className="flex items-center justify-between mb-4">
          <h2 className="text-2xl font-bold text-gray-800 flex items-center gap-2">
            <Briefcase className="w-6 h-6" />
            Client Projects
          </h2>
          <button
            onClick={() => setShowAddProject(true)}
            className="px-4 py-2 bg-amber-500 text-white rounded-lg hover:bg-amber-600 flex items-center gap-2"
          >
            <Plus className="w-4 h-4" />
            Add Project
          </button>
        </div>
        
        {showAddProject && (
          <div className="mb-4 p-4 bg-amber-50 rounded-lg">
            <input
              type="text"
              value={newProject.client}
              onChange={(e) => setNewProject({...newProject, client: e.target.value})}
              placeholder="Client name..."
              className="w-full p-2 border rounded-lg mb-2"
            />
            <input
              type="text"
              value={newProject.type}
              onChange={(e) => setNewProject({...newProject, type: e.target.value})}
              placeholder="Project type (e.g., Digital branding, Watercolor, etc)..."
              className="w-full p-2 border rounded-lg mb-2"
            />
            <input
              type="date"
              value={newProject.deadline}
              onChange={(e) => setNewProject({...newProject, deadline: e.target.value})}
              className="w-full p-2 border rounded-lg mb-2"
            />
            <div className="flex gap-2">
              <button onClick={addClientProject} className="px-4 py-2 bg-amber-500 text-white rounded-lg hover:bg-amber-600">
                Save
              </button>
              <button onClick={() => setShowAddProject(false)} className="px-4 py-2 bg-gray-300 rounded-lg hover:bg-gray-400">
                Cancel
              </button>
            </div>
          </div>
        )}
        
        <div className="space-y-3">
          {clientProjects.map(project => (
            <div key={project.id} className="p-4 bg-gray-50 rounded-lg">
              <div className="flex items-center justify-between mb-2">
                <div>
                  <h3 className="font-semibold text-gray-800">{project.client}</h3>
                  <p className="text-sm text-gray-600">{project.type}</p>
                </div>
                <button onClick={() => deleteProject(project.id)} className="text-red-500 hover:text-red-700">
                  <X className="w-5 h-5" />
                </button>
              </div>
              <div className="flex items-center justify-between">
                <span className="text-sm text-gray-600">Deadline: {project.deadline}</span>
                <select
                  value={project.status}
                  onChange={(e) => updateProjectStatus(project.id, e.target.value)}
                  className="text-sm p-1 border rounded"
                >
                  <option value="inquiry">Inquiry</option>
                  <option value="in-progress">In Progress</option>
                  <option value="completed">Completed</option>
                </select>
              </div>
            </div>
          ))}
        </div>
      </div>
    );
  };

  const renderCalendarView = () => {
    const { daysInMonth, startingDayOfWeek, month, year } = getDaysInMonth(selectedDate);
    const days = [];
    const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
    
    for (let i = 0; i < startingDayOfWeek; i++) {
      days.push(<div key={`empty-${i}`} className="h-28 bg-gray-50 border"></div>);
    }
    
    for (let day = 1; day <= daysInMonth; day++) {
      const date = new Date(year, month, day);
      const dateKey = date.toDateString();
      const isToday = date.toDateString() === new Date().toDateString();
      const isSelected = date.toDateString() === selectedDate.toDateString();
      
      const dayTasks = tasks[dateKey];
      const dayHabits = habits[dateKey];
      
      // Count tasks by category
      let wellnessCount = 0;
      let fitnessCount = 0;
      let socialCount = 0;
      let designCount = 0;
      
      if (dayTasks) {
        Object.values(dayTasks).forEach(periodTasks => {
          periodTasks.forEach(task => {
            if (task.category === 'wellness') wellnessCount++;
            if (task.category === 'fitness') fitnessCount++;
            if (task.category === 'social') socialCount++;
            if (task.category === 'design') designCount++;
          });
        });
      }
      
      const hasTasks = wellnessCount > 0 || fitnessCount > 0 || socialCount > 0 || designCount > 0;
      const hasHabits = dayHabits && dayHabits.length > 0;
      
      days.push(
        <div
          key={day}
          onClick={() => {
            setSelectedDate(date);
            setCurrentView('daily');
          }}
          className={`h-28 p-2 border cursor-pointer transition-all overflow-hidden ${
            isToday ? 'bg-blue-50 border-blue-400 border-2' : 'bg-white hover:bg-gray-50'
          } ${isSelected ? 'ring-2 ring-blue-500' : ''}`}
        >
          <div className={`text-sm font-bold mb-1 ${isToday ? 'text-blue-600' : 'text-gray-700'}`}>
            {day}
          </div>
          {(hasTasks || hasHabits) && (
            <div className="space-y-1">
              {wellnessCount > 0 && (
                <div className="text-xs text-pink-600 flex items-center gap-1">
                  <div className="w-2 h-2 bg-pink-400 rounded-full"></div>
                  <span>Wellness ({wellnessCount})</span>
                </div>
              )}
              {fitnessCount > 0 && (
                <div className="text-xs text-purple-600 flex items-center gap-1">
                  <div className="w-2 h-2 bg-purple-400 rounded-full"></div>
                  <span>Fitness ({fitnessCount})</span>
                </div>
              )}
              {socialCount > 0 && (
                <div className="text-xs text-blue-600 flex items-center gap-1">
                  <div className="w-2 h-2 bg-blue-400 rounded-full"></div>
                  <span>Social ({socialCount})</span>
                </div>
              )}
              {designCount > 0 && (
                <div className="text-xs text-amber-600 flex items-center gap-1">
                  <div className="w-2 h-2 bg-amber-400 rounded-full"></div>
                  <span>Design ({designCount})</span>
                </div>
              )}
            </div>
          )}
        </div>
      );
    }
    
    return (
      <div className="bg-white rounded-lg shadow-lg p-6">
        <div className="flex items-center justify-between mb-6">
          <h2 className="text-2xl font-bold text-gray-800">{monthNames[month]} {year}</h2>
          <div className="flex gap-2">
            <button
              onClick={() => {
                const newDate = new Date(selectedDate);
                newDate.setMonth(newDate.getMonth() - 1);
                setSelectedDate(newDate);
              }}
              className="px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300 transition-all"
            >
              Previous
            </button>
            <button
              onClick={() => setSelectedDate(new Date())}
              className="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all"
            >
              Today
            </button>
            <button
              onClick={() => {
                const newDate = new Date(selectedDate);
                newDate.setMonth(newDate.getMonth() + 1);
                setSelectedDate(newDate);
              }}
              className="px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300 transition-all"
            >
              Next
            </button>
          </div>
        </div>
        
        <div className="grid grid-cols-7 gap-2">
          {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (
            <div key={day} className="text-center font-semibold text-gray-600 py-2 text-sm">
              {day}
            </div>
          ))}
          {days}
        </div>
        
        <div className="mt-6 p-4 bg-gray-50 rounded-lg">
          <p className="text-sm text-gray-600">
            <strong>Tip:</strong> Click any date to view and edit that day's schedule. Days with activities show colored indicators for each category.
          </p>
        </div>
      </div>
    );
  };

  const renderDailyView = () => {
    const dateKey = selectedDate.toDateString();
    const dailyTasks = tasks[dateKey] || { morning: [], midday: [], afternoon: [], evening: [] };
    const dailyHabits = habits[dateKey] || [];
    const stats = getCompletionStats();

    return (
      <div className="space-y-6">
        <div className="bg-white rounded-lg shadow-lg p-6">
          <div className="flex items-center justify-between mb-6">
            <div>
              <h2 className="text-2xl font-bold text-gray-800">{formatDate(selectedDate)}</h2>
              <p className="text-gray-600">Your personalized daily flow</p>
            </div>
            <div className="flex gap-2">
              <button
                onClick={() => changeDate(-1)}
                className="px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300"
              >
                Previous
              </button>
              <button
                onClick={() => setSelectedDate(new Date())}
                className="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"
              >
                Today
              </button>
              <button
                onClick={() => changeDate(1)}
                className="px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300"
              >
                Next
              </button>
              <button
                onClick={() => setIsEditing(!isEditing)}
                className={`px-4 py-2 rounded-lg flex items-center gap-2 ${
                  isEditing ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-700'
                }`}
              >
                {isEditing ? <Save className="w-4 h-4" /> : <Edit2 className="w-4 h-4" />}
                {isEditing ? 'Done' : 'Edit'}
              </button>
            </div>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div className="bg-gradient-to-br from-pink-50 to-purple-50 rounded-lg p-4">
              <h3 className="font-semibold text-gray-800 mb-3 flex items-center gap-2">
                <Heart className="w-5 h-5 text-pink-500" />
                Daily Habits Tracker
              </h3>
              <div className="space-y-2">
                {dailyHabits.map(habit => (
                  <div
                    key={habit.id}
                    onClick={() => toggleHabit(habit.id)}
                    className="flex items-center gap-3 p-2 bg-white rounded-lg cursor-pointer hover:shadow-md transition-all"
                  >
                    {habit.completed ? (
                      <CheckCircle className="w-5 h-5 text-green-500" />
                    ) : (
                      <Circle className="w-5 h-5 text-gray-300" />
                    )}
                    <span className={habit.completed ? 'line-through text-gray-500' : 'text-gray-700'}>
                      {habit.name}
                    </span>
                  </div>
                ))}
              </div>
              <div className="mt-3 text-sm text-gray-600">
                Completion: {stats.habits.percentage}%
              </div>
            </div>

            <div className="bg-gradient-to-br from-blue-50 to-amber-50 rounded-lg p-4">
              <h3 className="font-semibold text-gray-800 mb-3 flex items-center gap-2">
                <TrendingUp className="w-5 h-5 text-blue-500" />
                Today's Progress
              </h3>
              <div className="space-y-3">
                <div>
                  <div className="flex justify-between text-sm mb-1">
                    <span className="text-gray-600">Tasks</span>
                    <span className="font-semibold">{stats.tasks.completed}/{stats.tasks.total}</span>
                  </div>
                  <div className="w-full bg-gray-200 rounded-full h-2">
                    <div className="bg-blue-500 h-2 rounded-full" style={{ width: `${stats.tasks.percentage}%` }}></div>
                  </div>
                </div>
                <div className="grid grid-cols-2 gap-2 text-sm">
                  <div className="flex items-center gap-2">
                    <div className="w-3 h-3 bg-pink-400 rounded-full"></div>
                    <span className="text-gray-700">Wellness</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <div className="w-3 h-3 bg-purple-400 rounded-full"></div>
                    <span className="text-gray-700">Fitness</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <div className="w-3 h-3 bg-blue-400 rounded-full"></div>
                    <span className="text-gray-700">Social Media</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <div className="w-3 h-3 bg-amber-400 rounded-full"></div>
                    <span className="text-gray-700">Design</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          {isEditing && (
            <div className="mb-6 p-4 bg-blue-50 rounded-lg">
              <button
                onClick={() => setShowAddTask(true)}
                className="w-full px-4 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 flex items-center justify-center gap-2"
              >
                <Plus className="w-5 h-5" />
                Add New Task
              </button>
              
              {showAddTask && (
                <div className="mt-4 p-4 bg-white rounded-lg">
                  <input
                    type="text"
                    value={newTask.text}
                    onChange={(e) => setNewTask({...newTask, text: e.target.value})}
                    placeholder="Task description..."
                    className="w-full p-2 border rounded-lg mb-2"
                  />
                  <input
                    type="time"
                    value={newTask.time}
                    onChange={(e) => setNewTask({...newTask, time: e.target.value})}
                    className="w-full p-2 border rounded-lg mb-2"
                  />
                  <select
                    value={newTask.category}
                    onChange={(e) => setNewTask({...newTask, category: e.target.value})}
                    className="w-full p-2 border rounded-lg mb-2"
                  >
                    <option value="wellness">Wellness</option>
                    <option value="fitness">Fitness</option>
                    <option value="social">Social Media</option>
                    <option value="design">Design</option>
                  </select>
                  <select
                    value={newTask.period}
                    onChange={(e) => setNewTask({...newTask, period: e.target.value})}
                    className="w-full p-2 border rounded-lg mb-2"
                  >
                    <option value="morning">Morning</option>
                    <option value="midday">Midday</option>
                    <option value="afternoon">Afternoon</option>
                    <option value="evening">Evening</option>
                  </select>
                  <div className="flex gap-2">
                    <button onClick={addTask} className="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                      Add Task
                    </button>
                    <button onClick={() => setShowAddTask(false)} className="px-4 py-2 bg-gray-300 rounded-lg hover:bg-gray-400">
                      Cancel
                    </button>
                  </div>
                </div>
              )}
            </div>
          )}

          {['morning', 'midday', 'afternoon', 'evening'].map(period => (
            <div key={period} className="mb-6">
              <h3 className="text-lg font-semibold text-gray-700 mb-3 capitalize flex items-center gap-2">
                <Clock className="w-5 h-5" />
                {period}
              </h3>
              <div className="space-y-2">
                {dailyTasks[period]?.map(task => (
                  <div
                    key={task.id}
                    className="flex items-center gap-4 p-4 bg-gray-50 rounded-lg hover:shadow-md transition-all"
                  >
                    <div onClick={() => toggleTask(period, task.id)} className="cursor-pointer">
                      {task.completed ? (
                        <CheckCircle className="w-6 h-6 text-green-500 flex-shrink-0" />
                      ) : (
                        <Circle className="w-6 h-6 text-gray-300 flex-shrink-0" />
                      )}
                    </div>
                    <div className="flex-1">
                      <div className={`font-medium ${task.completed ? 'line-through text-gray-500' : 'text-gray-800'}`}>
                        {task.text}
                      </div>
                      <div className="text-sm text-gray-500 mt-1">{task.time}</div>
                    </div>
                    <div className={`px-3 py-1 rounded-full text-xs font-medium flex items-center gap-1 ${getCategoryColor(task.category)}`}>
                      {getCategoryIcon(task.category)}
                      <span className="capitalize">{task.category}</span>
                    </div>
                    {isEditing && (
                      <button
                        onClick={() => deleteTask(period, task.id)}
                        className="text-red-500 hover:text-red-700"
                      >
                        <X className="w-5 h-5" />
                      </button>
                    )}
                  </div>
                ))}
                {dailyTasks[period]?.length === 0 && (
                  <div className="text-center py-6 text-gray-400">
                    No tasks scheduled for this time
                  </div>
                )}
              </div>
            </div>
          ))}
        </div>
      </div>
    );
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50 p-6">
      <div className="max-w-7xl mx-auto">
        <div className="mb-6">
          <h1 className="text-4xl font-bold text-gray-800 mb-2">Wellness & Business Planner</h1>
          <p className="text-gray-600">Balance your health, creativity, and business growth</p>
        </div>

        <div className="flex flex-wrap gap-4 mb-6">
          <button
            onClick={() => setCurrentView('daily')}
            className={`px-6 py-3 rounded-lg font-medium transition-all ${
              currentView === 'daily'
                ? 'bg-blue-500 text-white shadow-lg'
                : 'bg-white text-gray-700 hover:bg-gray-50'
            }`}
          >
            Daily Schedule
          </button>
          <button
            onClick={() => setCurrentView('calendar')}
            className={`px-6 py-3 rounded-lg font-medium transition-all ${
              currentView === 'calendar'
                ? 'bg-blue-500 text-white shadow-lg'
                : 'bg-white text-gray-700 hover:bg-gray-50'
            }`}
          >
            Monthly Calendar
          </button>
          <button
            onClick={() => setCurrentView('goals')}
            className={`px-6 py-3 rounded-lg font-medium transition-all ${
              currentView === 'goals'
                ? 'bg-blue-500 text-white shadow-lg'
                : 'bg-white text-gray-700 hover:bg-gray-50'
            }`}
          >
            Weekly Goals
          </button>
          <button
            onClick={() => setCurrentView('content')}
            className={`px-6 py-3 rounded-lg font-medium transition-all ${
              currentView === 'content'
                ? 'bg-blue-500 text-white shadow-lg'
                : 'bg-white text-gray-700 hover:bg-gray-50'
            }`}
          >
            Content Planning
          </button>
          <button
            onClick={() => setCurrentView('projects')}
            className={`px-6 py-3 rounded-lg font-medium transition-all ${
              currentView === 'projects'
                ? 'bg-blue-500 text-white shadow-lg'
                : 'bg-white text-gray-700 hover:bg-gray-50'
            }`}
          >
            Client Projects
          </button>
          <button
            onClick={() => setCurrentView('analytics')}
            className={`px-6 py-3 rounded-lg font-medium transition-all ${
              currentView === 'analytics'
                ? 'bg-blue-500 text-white shadow-lg'
                : 'bg-white text-gray-700 hover:bg-gray-50'
            }`}
          >
            Analytics
          </button>
        </div>

        {currentView === 'daily' && renderDailyView()}
        {currentView === 'calendar' && renderCalendarView()}
        {currentView === 'goals' && renderWeeklyGoals()}
        {currentView === 'content' && renderContentPlanning()}
        {currentView === 'projects' && renderClientProjects()}
        {currentView === 'analytics' && renderAnalytics()}
      </div>
    </div>
  );
};

export default WellnessScheduleApp;
